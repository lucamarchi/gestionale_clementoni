<h2>
	CRONOLOGIA CARICHI IN ENTRATA
</h2>

<table>
	<tr>
		<td>
			<uib-pagination total-items="totalItems" ng-model="currentPage" items-per-page="entryLimit" max-size="maxSize" class="pagination" boundary-links="true" force-ellipses="true"></uib-pagination>
		</td>
		<td>
			<button ng-if="userRole == 'logistica' || userRole == 'admin'" type="button" class="btn btn-primary" data-toggle="modal" href="#neworder" ng-click="createOrder()">Aggiungi Ordine</button>
		</td>
	</tr>
</table>

	


<table class="table table-bordered table-hover">
	<thead>
		<tr>
			<th><input ng-model="ddt"></th>
			<th>
				<select ng-model="fornitore" ng-options="fornitori for fornitori in features.fornitori">
				<option value="">-- seleziona --</option>
				</select>
			</th>
			<th><input type="date" ng-model="dataDdt"></th>
		</tr>
	    <tr>
			<th>DDT</th>
  			<th>Fornitore</th>
			<th>Data ddt</th>
			<th>Data Arrivo</th>
		</tr>
	</thead>
  	<tbody>
    	<tr ng-repeat="order in orders | filterca:ddt:fornitore:dataDdt | orderBy:'dataDdt':true | startFrom:(currentPage-1)*entryLimit | limitTo:entryLimit">
			<td><button type="button" class="btn btn-info btn-block" ng-click="openProductsOrder(order)" data-target="#orderproducts" data-toggle="modal">{{order.ddt}}</button></td>
  			<td>{{order.fornitore}}</td>
			<td>{{order.dataDdt | date:'medium'}}</td>
			<td>{{order.dataArrivo | date:'medium'}}</td>
			<td ng-if="userRole == 'logistica' || userRole == 'admin'">
				<button type="button" class="btn btn-warning btn-circle" ng-click="openOrder(order)" data-target="#neworder" data-toggle="modal">Modifica <span class="glyphicon glyphicon-cog"></button>
				<button type="button" class="btn btn-danger btn-circle" ng-click="prepareDeleteOrder(order, orders.indexOf(order))" data-target="#delete" data-toggle="modal">Cancella <span class="glyphicon glyphicon-trash"></span></button>	
			</td>
		</tr>
	</tbody>
</table>

<!-- Modal order_products.html-->
<div id="orderproducts" class="modal modal-xl fade" role="dialog">
	<div class="modal-dialog">
		<!-- Modal content-->
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<td><h2>DDT {{order.ddt}}</h2>
				<table class="table">
	    			<tr>
						<td><h4>{{order.dataDdt | date:'fullDate'}}</h4></td>
						<td><h4>FORNITORE {{order.fornitore}}</h4></td>
					</tr>
				</table>
			</div>
			<div class="modal-body">
				<div ng-include src="'public/carichi_in/order_products.html'"></div>
			</div>
			<div class="modal-footer">
				<div align="left">
					<button ng-if="userRole == 'logistica' || userRole == 'admin'" type="button" class="btn btn-primary" data-toggle="modal" data-target="#newproduct" ng-click="createProduct()">Aggiungi prodotto</button>
				</div>
				<div>
					<button type="button" class="btn btn-danger" data-dismiss="modal">Annulla</button>
					<button ng-if="order._id == undefined" type="button" class="btn btn-success" ng-click="confirmOrder()" data-dismiss="modal">Conferma</button>
					<button ng-if="order._id != undefined" type="button" class="btn btn-success" ng-click="updateOrder(order)" data-dismiss="modal">Conferma</button>
				</div>
			</div>
		</div>
	</div>
</div>

<!-- Modal new_product.html-->
<div id="newproduct" class="modal fade" role="dialog">
	<div class="modal-dialog">
		<!-- Modal content-->
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<h4 class="modal-title">INSERIRE PRODOTTO</h4>
			</div>
			<div class="modal-body">
				<div ng-include src="'public/carichi_in/new_product.html'"></div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-danger" data-dismiss="modal">Annulla</button>
				<button ng-if="productForm.$valid" type="button" class="btn btn-success" ng-click="addProduct()" data-dismiss="modal">Conferma</button>
			</div>
		</div>
	</div>
</div>

<div id="updateproduct" class="modal fade" role="dialog">
	<div class="modal-dialog">
		<!-- Modal content-->
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<h4 class="modal-title">MODIFICA PRODOTTO</h4>
			</div>
			<div class="modal-body">
				<div ng-include src="'public/carichi_in/new_product.html'"></div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-danger" data-dismiss="modal">Annulla</button>
				<button ng-if="productForm.$valid" type="button" class="btn btn-success" ng-click="updateProduct()" data-dismiss="modal">Conferma</button>
			</div>
		</div>
	</div>
</div>

<!-- Modal new_order.html-->
<div id="neworder" class="modal fade" role="dialog">
	<div class="modal-dialog">
		<!-- Modal content-->
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<h4 ng-if="order._id == undefined" class="modal-title">CREA ORDINE</h4>
				<h4 ng-if="order._id != undefined" class="modal-title">MODIFICA ORDINE</h4>
			</div>
			<div class="modal-body">
				<div ng-include src="'public/carichi_in/new_order.html'"></div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-danger" data-dismiss="modal">Annulla</button>
				<button ng-if="orderForm.$valid && order._id == undefined" type="button" class="btn btn-success" data-toggle="modal" data-target="#orderproducts" data-dismiss="modal">Conferma</button>
				<button ng-if="orderForm.$valid && order._id != undefined" type="button" class="btn btn-warning" ng-click="updateOrder(order)" data-dismiss="modal">Modifica</button>
			</div>
		</div>
	</div>
</div>

<!-- Modal deleteOrder/Product-->
<div id="delete" class="modal fade" role="dialog">
	<div class="modal-dialog">
		<!-- Modal content-->
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<h3 ng-if="product" class="modal-title" align="center">Elimina Prodotto</h3>
				<h3 ng-if="order" class="modal-title" align="center">Elimina Ordine</h3>
			</div>
			<div class="modal-body">
				<div ng-if="product._id">Verr√† eliminato anche il rispettivo prodotto all'interno dello stock</div>
				<div ng-if="order">Verranno eliminati anche tutti i prodotti ed i corrispondenti all'interno dello stock</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-danger" data-dismiss="modal">Annulla</button>
				<button ng-if="product" type="button" class="btn btn-success" ng-click="deleteProduct(product, productsOrder.indexOf(product))" data-dismiss="modal">Conferma</button>
				<button ng-if="order" type="button" class="btn btn-success" ng-click="deleteOrder(order, orders.indexOf(order))" data-dismiss="modal">Conferma</button>
			</div>
		</div>
	</div>
</div>
